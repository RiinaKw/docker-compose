version: "3"

services:
    data:
        container_name: example_data
        image: busybox
        volumes:
            - ./project:/project

    web:
        # locaolhost:12000 で PHP が動く web サーバ
        container_name: example_web
        build: ./web
        volumes_from:
            - data  # コンテナ名ではなくサービス名であることに注意
        ports:
            - 12000:80

    # docker-compose run --rm composer と打つとこのコンテナが呼ばれる
    # composer install のほか、composer.json で定義した phpcs なども呼べる
    composer:
        build: ./composer
        container_name: example_composer
        volumes_from:
            - data
